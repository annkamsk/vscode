# VSCode Security Issues

## Compile-time issues

This section mentions the issues discovered while running VSCode's code with tsec.

### Running tsec

#### Build
```
    git clone https://github.com/googleinterns/tsec
    cd tsec
    npm install -g gulp
    npm install
    npm install -g typescript
    tsc
```

#### Run

In VSCode's `package.json` add:

```
"scripts": {
                "tsec-compile-check" : "{your tsec dir}/bin/tsec -p {tsconfig} --noEmit"
        }
```

where `{tsconfig}` is either `src/tsconfig.json` or `src/tsconfig.monaco.json` (the second is a smaller subset of the first).

You should get 103 errors from `src/tsconfig.json` and 28 from `src/tsconfig.monaco.json`. Mostly caused by assigning a string to innerHTML property. 

### Issues

#### From tsconfig.monaco.json

|Nr|At|Error|Code|Fix type|
| --- | --- | --- | --- | --- |
|1|[src/vs/editor/browser/config/charWidthReader.ts#L132](https://github.com/microsoft/vscode/blob/master/src/vs/editor/browser/config/charWidthReader.ts#L132)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```testElement.innerHTML = htmlString;  ```|||
|2|[src/vs/editor/browser/view/viewLayer.ts#L510](https://github.com/microsoft/vscode/blob/master/src/vs/editor/browser/view/viewLayer.ts#L510)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNode.innerHTML = newLinesHTML;```|||
|3|[src/vs/base/browser/markdownRenderer.ts#L158](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/markdownRenderer.ts#L158)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```span.innerHTML = strValue;```|||
|4|[src/vs/base/browser/markdownRenderer.ts#L233](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/markdownRenderer.ts#L233)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```element.innerHTML = insane(renderedMarkdown, {  234 allowedSchemes,... 249 filter  250 });```|||
|5|[src/vs/base/browser/ui/selectBox/selectBoxCustom.ts#L708](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/selectBox/selectBoxCustom.ts#L708)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```container.innerHTML = this.options[longest].text + (!!this.options[longest].decoratorRight ? (this.options[longest].decoratorRight + ' ') : '');```|||
|6|[src/vs/editor/contrib/codelens/codelensWidget.ts#L106](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/codelens/codelensWidget.ts#L106)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = '<span>no commands</span>';  ```|||
|7|[src/vs/editor/contrib/codelens/codelensWidget.ts#L113](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/codelens/codelensWidget.ts#L113)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = innerHtml;```|||
|8|[src/vs/base/browser/ui/inputbox/inputBox.ts#L173](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/inputbox/inputBox.ts#L173)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.mirror.innerHTML = '&#160;';  ```|||
|9|[src/vs/base/browser/ui/inputbox/inputBox.ts#L532](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/inputbox/inputBox.ts#L532)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.mirror.innerHTML = '&#160;';  ```|||
|10|[src/vs/editor/contrib/peekView/peekView.ts#L211](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L211)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._primaryHeading.innerHTML = strings.escape(primaryHeading);```|||
|11|[src/vs/editor/contrib/peekView/peekView.ts#L214](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L214)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._secondaryHeading.innerHTML = strings.escape(secondaryHeading);```|||
|12|[src/vs/editor/contrib/peekView/peekView.ts#L224](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L224)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._metaHeading.innerHTML = strings.escape(value);```|||
|13|[src/vs/base/browser/ui/highlightedlabel/highlightedLabel.ts#L91](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/highlightedlabel/highlightedLabel.ts#L91)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNode.innerHTML = htmlContent;  ```|||
|14|[src/vs/base/browser/ui/iconLabel/iconLabel.ts#L190](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/iconLabel/iconLabel.ts#L190)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|Done locally||
|15|[src/vs/base/browser/ui/iconLabel/iconLabel.ts#L197](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/iconLabel/iconLabel.ts#L197)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|Done locally||
|16|[src/vs/base/browser/ui/iconLabel/iconLabel.ts#L253](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/iconLabel/iconLabel.ts#L253)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|Done locally||
|17|[src/vs/base/browser/ui/iconLabel/iconLabel.ts#L261](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/iconLabel/iconLabel.ts#L261)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|Done locally||
|18|[src/vs/base/browser/ui/tree/abstractTree.ts#L884](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/tree/abstractTree.ts#L884)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.messageDomNode.innerHTML = '';  ```|Done locally||
|19|[src/vs/editor/contrib/gotoSymbol/peek/referencesWidget.ts#L432](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/gotoSymbol/peek/referencesWidget.ts#L432)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._messageContainer.innerHTML = nls.localize('noResults', "No results");  ```|||
|20|[src/vs/editor/contrib/parameterHints/parameterHintsWidget.ts#L197](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/parameterHints/parameterHintsWidget.ts#L197)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNodes.signature.innerHTML = '';  ```|Done locally||
|21|[src/vs/editor/contrib/parameterHints/parameterHintsWidget.ts#L198](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/parameterHints/parameterHintsWidget.ts#L198)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNodes.docs.innerHTML = '';```|Done locally||
|22|[src/vs/editor/contrib/suggest/suggestWidget.ts#L375](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/suggest/suggestWidget.ts#L375)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.docs.innerHTML = '';  ```|Done locally||
|23|[src/vs/base/worker/defaultWorkerFactory.ts#L16](https://github.com/microsoft/vscode/blob/master/src/vs/base/worker/defaultWorkerFactory.ts#L16)|TS21228: Constructing Web Workers can cause code to be loaded from an untrusted URL.|```return new Worker(globals.MonacoEnvironment.getWorkerUrl(workerId, label));  ```|||
|24|[src/vs/base/worker/defaultWorkerFactory.ts#L24](https://github.com/microsoft/vscode/blob/master/src/vs/base/worker/defaultWorkerFactory.ts#L24)|TS21228: Constructing Web Workers can cause code to be loaded from an untrusted URL.|```return new Worker(workerUrl, { name: label });  ```|||
|25|[src/vs/editor/standalone/browser/colorizer.ts#L43](https://github.com/microsoft/vscode/blob/master/src/vs/editor/standalone/browser/colorizer.ts#L43)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```domNode.innerHTML = str;```|||
|26|[src/vs/base/browser/ui/button/button.ts#L183](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/button/button.ts#L183)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._element.innerHTML = renderCodicons(escape(value));```|||
|27|[src/vs/base/parts/quickinput/browser/quickInput.ts#L280](https://github.com/microsoft/vscode/blob/master/src/vs/base/parts/quickinput/browser/quickInput.ts#L280)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.ui.title.innerHTML = '&nbsp;';  ```|||
|28|[src/vs/editor/standalone/browser/inspectTokens/inspectTokens.ts#L242](https://github.com/microsoft/vscode/blob/master/src/vs/editor/standalone/browser/inspectTokens/inspectTokens.ts#L242)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = result;  Found 28 errors. ```|||

#### From tsconfig.json
|Nr|At|Error|Code|Fix type|
| --- | --- | --- | --- | --- |
|1|[src/vs/base/browser/markdownRenderer.ts#L158](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/markdownRenderer.ts#L158)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```span.innerHTML = strValue;```|||
|2|[src/vs/base/browser/markdownRenderer.ts#L233](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/markdownRenderer.ts#L233)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```element.innerHTML = insane(renderedMarkdown, {  234 allowedSchemes,... 249 filter  250 });```|||
|3|[src/vs/base/browser/ui/selectBox/selectBoxCustom.ts#L708](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/selectBox/selectBoxCustom.ts#L708)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```container.innerHTML = this.options[longest].text + (!!this.options[longest].decoratorRight ? (this.options[longest].decoratorRight + ' ') : '');```|||
|4|[src/vs/base/browser/ui/button/button.ts#L183](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/button/button.ts#L183)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._element.innerHTML = renderCodicons(escape(value));```|||
|5|[src/vs/base/browser/ui/codicons/codiconLabel.ts#L16](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/codicons/codiconLabel.ts#L16)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._container.innerHTML = renderCodicons(escape(text ?? ''));  ```|||
|6|[src/vs/base/browser/ui/inputbox/inputBox.ts#L173](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/inputbox/inputBox.ts#L173)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.mirror.innerHTML = '&#160;';  ```|||
|7|[src/vs/base/browser/ui/inputbox/inputBox.ts#L532](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/inputbox/inputBox.ts#L532)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.mirror.innerHTML = '&#160;';  ```|||
|8|[src/vs/base/browser/ui/highlightedlabel/highlightedLabel.ts#L91](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/highlightedlabel/highlightedLabel.ts#L91)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNode.innerHTML = htmlContent;  ```|||
|9|[src/vs/base/browser/ui/menu/menubar.ts#L551](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/menu/menubar.ts#L551)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```titleElement.innerHTML = innerHtml;  ```|||
|10|[src/vs/base/browser/ui/menu/menubar.ts#L553](https://github.com/microsoft/vscode/blob/master/src/vs/base/browser/ui/menu/menubar.ts#L553)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```titleElement.innerHTML = cleanMenuLabel.replace(/&&/g, '&');```|||
|11|[src/vs/base/parts/quickinput/browser/quickInput.ts#L280](https://github.com/microsoft/vscode/blob/master/src/vs/base/parts/quickinput/browser/quickInput.ts#L280)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.ui.title.innerHTML = '&nbsp;';  ```|||
|12|[src/vs/base/worker/defaultWorkerFactory.ts#L16](https://github.com/microsoft/vscode/blob/master/src/vs/base/worker/defaultWorkerFactory.ts#L16)|TS21228: Constructing Web Workers can cause code to be loaded from an untrusted URL.|```return new Worker(globals.MonacoEnvironment.getWorkerUrl(workerId, label));  ```|||
|13|[src/vs/base/worker/defaultWorkerFactory.ts#L24](https://github.com/microsoft/vscode/blob/master/src/vs/base/worker/defaultWorkerFactory.ts#L24)|TS21228: Constructing Web Workers can cause code to be loaded from an untrusted URL.|```return new Worker(workerUrl, { name: label });  ```|||
|14|[src/vs/editor/browser/config/charWidthReader.ts#L132](https://github.com/microsoft/vscode/blob/master/src/vs/editor/browser/config/charWidthReader.ts#L132)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```testElement.innerHTML = htmlString;  ```|||
|15|[src/vs/editor/browser/view/viewLayer.ts#L510](https://github.com/microsoft/vscode/blob/master/src/vs/editor/browser/view/viewLayer.ts#L510)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.domNode.innerHTML = newLinesHTML;```|||
|16|[src/vs/editor/contrib/codelens/codelensWidget.ts#L106](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/codelens/codelensWidget.ts#L106)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = '<span>no commands</span>';  ```|||
|17|[src/vs/editor/contrib/codelens/codelensWidget.ts#L113](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/codelens/codelensWidget.ts#L113)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = innerHtml;```|||
|18|[src/vs/editor/contrib/peekView/peekView.ts#L211](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L211)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._primaryHeading.innerHTML = strings.escape(primaryHeading);```|||
|19|[src/vs/editor/contrib/peekView/peekView.ts#L214](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L214)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._secondaryHeading.innerHTML = strings.escape(secondaryHeading);```|||
|20|[src/vs/editor/contrib/peekView/peekView.ts#L224](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/peekView/peekView.ts#L224)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._metaHeading.innerHTML = strings.escape(value);```|||
|21|[src/vs/editor/contrib/gotoSymbol/peek/referencesWidget.ts#L432](https://github.com/microsoft/vscode/blob/master/src/vs/editor/contrib/gotoSymbol/peek/referencesWidget.ts#L432)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._messageContainer.innerHTML = nls.localize('noResults', "No results");  ```|||
|22|[src/vs/workbench/contrib/comments/browser/commentThreadWidget.ts#L700](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/comments/browser/commentThreadWidget.ts#L700)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._headingLabel.innerHTML = strings.escape(label);  ```|||
|23|[src/vs/workbench/contrib/comments/browser/commentsTreeViewer.ts#L123](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/comments/browser/commentsTreeViewer.ts#L123)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.commentText.innerHTML = '';```|||
|24|[src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L507](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L507)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.viewWelcomeContainer.innerHTML = '';  ```|||
|25|[src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L516](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L516)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.viewWelcomeContainer.innerHTML = '';  ```|||
|26|[src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L523](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/parts/views/viewPaneContainer.ts#L523)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.viewWelcomeContainer.innerHTML = '';  ```|||
|27|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L163](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L163)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.templateData.editorContainer.innerHTML = '';  ```|||
|28|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L223](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L223)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.markdownContainer.innerHTML = '';```|||
|29|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L243](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L243)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.markdownContainer.innerHTML = '';```|||
|30|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L294](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L294)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.templateData.foldingIndicator.innerHTML = '';```|||
|31|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L297](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L297)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.templateData.foldingIndicator.innerHTML = renderCodicons('$(chevron-right)');```|||
|32|[src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L300](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/markdownCell.ts#L300)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.templateData.foldingIndicator.innerHTML = renderCodicons('$(chevron-down)');  ```|||
|33|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L91](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L91)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.label.innerHTML = renderCodicons(this._commandAction.label ?? '');  ```|||
|34|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L393](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L393)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```dragImageContainer.innerHTML = templateData.container.innerHTML;```|||
|35|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L415](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L415)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.cellContainer.innerHTML = '';```|||
|36|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L805](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L805)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```dragImageContainer.innerHTML = templateData.container.innerHTML;```|||
|37|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L817](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L817)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```editorContainer.innerHTML = richEditorText;  ```|||
|38|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L995](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L995)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.cellRunStatusContainer.innerHTML = renderCodicons('$(check)');  ```|||
|39|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L997](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L997)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.cellRunStatusContainer.innerHTML = renderCodicons('$(error)');  ```|||
|40|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L999](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L999)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.cellRunStatusContainer.innerHTML = renderCodicons('$(sync~spin)');  ```|||
|41|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L1001](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L1001)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.cellRunStatusContainer.innerHTML = '';  ```|||
|42|[src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L1065](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts#L1065)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.outputContainer.innerHTML = '';```|||
|43|[src/vs/workbench/browser/actions/developerActions.ts#L182](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/actions/developerActions.ts#L182)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```keyboardMarker.innerHTML = '';```|||
|44|[src/vs/workbench/browser/parts/editor/editorPart.ts#L61](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/parts/editor/editorPart.ts#L61)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.element.innerHTML = '';```|||
|45|[src/vs/workbench/browser/parts/compositePart.ts#L412](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/browser/parts/compositePart.ts#L412)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```titleLabel.innerHTML = strings.escape(title);  ```|||
|46|[src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L640](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L640)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.descriptionElement.innerHTML = '';  ```|||
|47|[src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L653](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L653)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.otherOverridesElement.innerHTML = '';```|||
|48|[src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L690](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L690)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.deprecationWarningElement.innerHTML = '';```|||
|49|[src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L824](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L824)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```templateData.parent.innerHTML = '';  ```|||
|50|[src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L1369](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/preferences/browser/settingsTree.ts#L1369)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.enumDescriptionElement.innerHTML = '';  ```|||
|51|[src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts#L82](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts#L82)|TS21228: Do not assign variables to HTMLScriptElement#text or HTMLScriptElement#textContent, as this can lead to XSS.|```scriptTag.text = node.innerText;```|||
|52|[src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts#L402](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts#L402)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```document.getElementById('container')!.innerHTML = '';  ```|||
|53|[src/vs/workbench/contrib/scm/browser/scmViewPane.ts#L143](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/scm/browser/scmViewPane.ts#L143)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.label.innerHTML = renderCodicons(escape(this.getAction().label));```|||
|54|[src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts#L58](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts#L58)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|||
|55|[src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts#L108](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts#L108)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this.container.innerHTML = '';```|||
|56|[src/vs/workbench/contrib/extensions/browser/extensionEditor.ts#L432](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/browser/extensionEditor.ts#L432)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.content.innerHTML = ''; // Clear content before setting navbar actions.```|||
|57|[src/vs/workbench/contrib/extensions/browser/extensionEditor.ts#L563](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/browser/extensionEditor.ts#L563)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```template.content.innerHTML = '';```|||
|58|[src/vs/workbench/contrib/codeEditor/browser/inspectEditorTokens/inspectEditorTokens.ts#L250](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/codeEditor/browser/inspectEditorTokens/inspectEditorTokens.ts#L250)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = text;  ```|||
|59|[src/vs/workbench/contrib/watermark/browser/watermark.ts#L144](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/watermark/browser/watermark.ts#L144)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```dd.innerHTML = keybinding.element.outerHTML;```|||
|60|[src/vs/workbench/contrib/welcome/overlay/browser/welcomeOverlay.ts#L189](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/welcome/overlay/browser/welcomeOverlay.ts#L189)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```dom.append(div, $('span.arrow')).innerHTML = arrow;  ```|||
|61|[src/vs/workbench/contrib/welcome/overlay/browser/welcomeOverlay.ts#L199](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/welcome/overlay/browser/welcomeOverlay.ts#L199)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```dom.append(div, $('span.arrow')).innerHTML = arrow;  ```|||
|62|[src/vs/workbench/contrib/welcome/page/browser/welcomePage.ts#L320](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/welcome/page/browser/welcomePage.ts#L320)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```prodName.innerHTML = this.productService.nameLong;```|||
|63|[src/vs/workbench/services/extensions/browser/webWorkerExtensionHost.ts#L72](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/services/extensions/browser/webWorkerExtensionHost.ts#L72)|TS21228: Constructing Web Workers can cause code to be loaded from an untrusted URL.|```const worker = new Worker(url, { name: 'WorkerExtensionHost' });  ```|||
|64|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L61](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L61)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```document.body.innerHTML = BaseHtml();  ```|||
|65|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L313](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L313)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = `${details}<table>${table}</table>`;  ```|||
|66|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L590](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L590)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```similarIssues.innerHTML = '';  ```|||
|67|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L601](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L601)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```similarIssues.innerHTML = '';  ```|||
|68|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L824](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L824)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionTitle.innerHTML = `${localize('stepsToReproduce', "Steps to Reproduce")} <span class="required-input">*</span>`;  ```|||
|69|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L825](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L825)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionSubtitle.innerHTML = localize('bugDescription', "Share the steps needed to reliably reproduce the problem. Please include actual and expected results. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.");  ```|||
|70|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L839](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L839)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionTitle.innerHTML = `${localize('stepsToReproduce', "Steps to Reproduce")} <span class="required-input">*</span>`;  ```|||
|71|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L840](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L840)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionSubtitle.innerHTML = localize('performanceIssueDesciption', "When did this performance issue happen? Does it occur on startup or after a specific series of actions? We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.");  ```|||
|72|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L842](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L842)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionTitle.innerHTML = `${localize('description', "Description")} <span class="required-input">*</span>`;  ```|||
|73|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L843](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L843)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionSubtitle.innerHTML = localize('featureRequestDescription', "Please describe the feature you would like to see. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.");  ```|||
|74|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L854](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L854)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionTitle.innerHTML = `${localize('expectedResults', "Expected Results")} <span class="required-input">*</span>`;```|||
|75|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L855](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L855)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```descriptionSubtitle.innerHTML = localize('settingsSearchResultsDescription', "Please list the results that you were expecting to see when you searched with this query. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.");  ```|||
|76|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1018](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1018)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = renderedData;```|||
|77|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1058](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1058)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```extensionsSelector.innerHTML = '<option></option>' + extensionOptions.map(extension => makeOption(extension, selectedExtension)).join('\n');```|||
|78|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1128](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1128)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = `<code>${state.processInfo}</code>`;  ```|||
|79|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1140](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1140)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = localize('disabledExtensions', "Extensions are disabled");  ```|||
|80|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1148](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1148)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = 'Extensions: none' + themeExclusionStr;```|||
|81|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1153](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1153)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = `<table>${table}</table>${themeExclusionStr}`;  ```|||
|82|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1161](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1161)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = 'Extensions: none';```|||
|83|[src/vs/code/electron-browser/issue/issueReporterMain.ts#L1166](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/issue/issueReporterMain.ts#L1166)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```target.innerHTML = `<table>${table}</table>`;  ```|||
|84|[src/vs/code/electron-browser/processExplorer/processExplorerMain.ts#L267](https://github.com/microsoft/vscode/blob/master/src/vs/code/electron-browser/processExplorer/processExplorerMain.ts#L267)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```container.innerHTML = '';  ```|||
|85|[src/vs/editor/standalone/browser/colorizer.ts#L43](https://github.com/microsoft/vscode/blob/master/src/vs/editor/standalone/browser/colorizer.ts#L43)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```domNode.innerHTML = str;```|||
|86|[src/vs/editor/standalone/browser/inspectTokens/inspectTokens.ts#L242](https://github.com/microsoft/vscode/blob/master/src/vs/editor/standalone/browser/inspectTokens/inspectTokens.ts#L242)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```this._domNode.innerHTML = result;  ```|||
|87|[src/vs/editor/test/browser/controller/imeTester.ts#L59](https://github.com/microsoft/vscode/blob/master/src/vs/editor/test/browser/controller/imeTester.ts#L59)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```output.innerHTML = r;  ```|||
|88|[src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L400](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L400)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```el.innerHTML = renderCodicons(escape(` $(alert) Unresponsive`));```|||
|89|[src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L407](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L407)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```el.innerHTML = renderCodicons(escape(`$(bug) ${nls.localize('errors', "{0} uncaught errors", element.status.runtimeErrors.length)}`));```|||
|90|[src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L413](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L413)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```el.innerHTML = renderCodicons(escape(`$(alert) ${element.status.messages[0].message}`));```|||
|91|[src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L419](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L419)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```el.innerHTML = renderCodicons(escape(`$(remote) ${element.description.extensionLocation.authority}`));```|||
|92|[src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L424](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/contrib/extensions/electron-browser/runtimeExtensionsEditor.ts#L424)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```el.innerHTML = renderCodicons(escape(`$(remote) ${hostLabel}`));```|||
|93|[src/vs/workbench/test/browser/part.test.ts#L66](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/test/browser/part.test.ts#L66)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```titleLabel.innerHTML = 'Title';  ```|||
|94|[src/vs/workbench/test/browser/part.test.ts#L75](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/test/browser/part.test.ts#L75)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```contentSpan.innerHTML = 'Content';```|||
|95|[src/vs/workbench/test/browser/part.test.ts#L95](https://github.com/microsoft/vscode/blob/master/src/vs/workbench/test/browser/part.test.ts#L95)|TS21228: Assigning directly to Element#innerHTML can result in XSS vulnerabilities.|```contentSpan.innerHTML = 'Content';Found 95 errors. ```|||
